
<!DOCTYPE html>
<html>
<head>
  
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <title>Device &mdash; pyzkaccess</title>

    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <link rel="stylesheet" href="../../../css/alabaster.css" type="text/css">
    <link rel="stylesheet" href="../../../css/alabaster-overrides.css" type="text/css">

    

    
      <script src="../../../search/main.js"></script>
    

    

    <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

    
  
</head>
<body>

  <div class="document">
    <div class="documentwrapper">
      <div class="bodywrapper">
        <div class="body" role="main">
          
            <h1 id="module-pyzkaccessdevice">Module pyzkaccess.device</h1>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>

    <span class="s1">&#39;ZKModel&#39;</span><span class="p">,</span>

    <span class="s1">&#39;ZK100&#39;</span><span class="p">,</span>

    <span class="s1">&#39;ZK200&#39;</span><span class="p">,</span>

    <span class="s1">&#39;ZK400&#39;</span><span class="p">,</span>

    <span class="s1">&#39;ZKDevice&#39;</span>

<span class="p">]</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">Optional</span>

<span class="kn">from</span> <span class="nn">.common</span> <span class="kn">import</span> <span class="n">DocDict</span>

<span class="kn">from</span> <span class="nn">.enum</span> <span class="kn">import</span> <span class="n">RelayGroup</span>

<span class="k">class</span> <span class="nc">ZKModel</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot;Base class for concrete ZK model Contains model-specific</span>

<span class="sd">    definitions</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#: Name of model</span>

    <span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1">#: Relays count</span>

    <span class="n">relays</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1">#: Definition of relay numbers (count must be equal to `relays`)</span>

    <span class="n">relays_def</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1">#: Definition of relay groups (count must be equal to `relays`)</span>

    <span class="n">groups_def</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1">#: Definition of reader numbers</span>

    <span class="n">readers_def</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1">#: Definition of door numbers</span>

    <span class="n">doors_dev</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1">#: Definition of aux input numbers</span>

    <span class="n">aux_inputs_def</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1">#: Anti-passback rules available on concrete device model</span>

    <span class="n">anti_passback_rules</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c1">#: Interlock rules available on concrete device model</span>

    <span class="n">interlock_rules</span> <span class="o">=</span> <span class="bp">None</span>

<span class="k">class</span> <span class="nc">ZK400</span><span class="p">(</span><span class="n">ZKModel</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;ZKAccess C3-400 model&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;C3-400&#39;</span>

    <span class="n">relays</span> <span class="o">=</span> <span class="mi">8</span>

    <span class="n">relays_def</span> <span class="o">=</span> <span class="p">(</span>

        <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>

        <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span>

    <span class="p">)</span>

    <span class="n">groups_def</span> <span class="o">=</span> <span class="p">(</span>

        <span class="n">RelayGroup</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">RelayGroup</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">RelayGroup</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">RelayGroup</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span>

        <span class="n">RelayGroup</span><span class="o">.</span><span class="n">lock</span><span class="p">,</span> <span class="n">RelayGroup</span><span class="o">.</span><span class="n">lock</span><span class="p">,</span> <span class="n">RelayGroup</span><span class="o">.</span><span class="n">lock</span><span class="p">,</span> <span class="n">RelayGroup</span><span class="o">.</span><span class="n">lock</span>

    <span class="p">)</span>

    <span class="n">readers_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="n">doors_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="n">aux_inputs_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="n">anti_passback_rules</span> <span class="o">=</span> <span class="n">DocDict</span><span class="p">({</span>

        <span class="mi">0</span><span class="p">:</span>   <span class="s1">&#39;Anti-passback disabled&#39;</span><span class="p">,</span>

        <span class="mi">1</span><span class="p">:</span>   <span class="s1">&#39;Enable the anti-passback function Door 1 and Door 2&#39;</span><span class="p">,</span>

        <span class="mi">2</span><span class="p">:</span>   <span class="s1">&#39;Enable the anti•passback function between Door 3 and Door 4&#39;</span><span class="p">,</span>

        <span class="mi">3</span><span class="p">:</span>   <span class="s1">&#39;Enable the anti-passback function between Door 1 and Door 2, and between &#39;</span>

             <span class="s1">&#39;Door 3 and Door 4&#39;</span><span class="p">,</span>

        <span class="mi">4</span><span class="p">:</span>   <span class="s1">&#39;Enable the anti-passback function between Door 1,2 and Door 3,4&#39;</span><span class="p">,</span>

        <span class="mi">5</span><span class="p">:</span>   <span class="s1">&#39;Enable the anti-passback function between Door 1 and Door 2,3&#39;</span><span class="p">,</span>

        <span class="mi">6</span><span class="p">:</span>   <span class="s1">&#39;Enable the anti-passback function between Door 1 and Door 2,3,4&#39;</span><span class="p">,</span>

        <span class="mi">16</span><span class="p">:</span>  <span class="s1">&#39;Anti-passback is supported only between the readers of Door 1&#39;</span><span class="p">,</span>

        <span class="mi">32</span><span class="p">:</span>  <span class="s1">&#39;Anti-passback is supported only between the readers of Door 2&#39;</span><span class="p">,</span>

        <span class="mi">64</span><span class="p">:</span>  <span class="s1">&#39;Anti-passback is supported only between the readers of Door 3&#39;</span><span class="p">,</span>

        <span class="mi">128</span><span class="p">:</span> <span class="s1">&#39;Anti-passback is supported only between the readers of Door 4&#39;</span><span class="p">,</span>

        <span class="mi">96</span><span class="p">:</span>  <span class="s1">&#39;Anti-passback is supported concurrently among Door 2 and Door 3 readers respectively&#39;</span><span class="p">,</span>

        <span class="mi">160</span><span class="p">:</span> <span class="s1">&#39;Anti-passback is supported concurrently among Door 2 and Door 4 readers respectively&#39;</span><span class="p">,</span>

        <span class="mi">196</span><span class="p">:</span> <span class="s1">&#39;Anti-passback is supported concurrently among Door 3 and Door 4 readers respectively&#39;</span><span class="p">,</span>

        <span class="mi">112</span><span class="p">:</span> <span class="s1">&#39;Anti-passback is supported concurrently among Door 1, 2, 3 readers respectively&#39;</span><span class="p">,</span>

        <span class="mi">176</span><span class="p">:</span> <span class="s1">&#39;Anti-passback is supported concurrently among Door 1, 2, 4 readers respectively&#39;</span><span class="p">,</span>

        <span class="mi">208</span><span class="p">:</span> <span class="s1">&#39;Anti-passback is supported concurrently among Door 1, 3, 4 readers respectively&#39;</span><span class="p">,</span>

        <span class="mi">224</span><span class="p">:</span> <span class="s1">&#39;Anti-passback is supported concurrently among Door 2, 3, 4 readers respectively&#39;</span><span class="p">,</span>

        <span class="mi">240</span><span class="p">:</span> <span class="s1">&#39;Anti-passback is supported concurrently among Door 1, 2, 3, 4 readers respectively&#39;</span><span class="p">,</span>

    <span class="p">})</span>

    <span class="n">interlock_rules</span> <span class="o">=</span> <span class="n">DocDict</span><span class="p">({</span>

        <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Interlock disabled&#39;</span><span class="p">,</span>

        <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Interlock Door 1 and Door 2 mutually&#39;</span><span class="p">,</span>

        <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Interlock Door 3 and Door 4 mutually&#39;</span><span class="p">,</span>

        <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Interlock Door 1, Door 2 and Door 3 mutually&#39;</span><span class="p">,</span>

        <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Interlock Door 1 and Door 2 mutually and interlock Door 3 and Door 4 mutually&#39;</span><span class="p">,</span>

        <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;Interlock Door 1, Door 2, Door 3, Door 4 mutually&#39;</span><span class="p">,</span>

    <span class="p">})</span>

<span class="k">class</span> <span class="nc">ZK200</span><span class="p">(</span><span class="n">ZKModel</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;ZKAccess C3-200&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;C3-200&#39;</span>

    <span class="n">relays</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="n">relays_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">groups_def</span> <span class="o">=</span> <span class="p">(</span><span class="n">RelayGroup</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">RelayGroup</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">RelayGroup</span><span class="o">.</span><span class="n">lock</span><span class="p">,</span> <span class="n">RelayGroup</span><span class="o">.</span><span class="n">lock</span><span class="p">)</span>

    <span class="n">readers_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># FIXME: fix ZKAccess.doors for C3-200</span>

    <span class="n">doors_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">aux_inputs_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">anti_passback_rules</span> <span class="o">=</span> <span class="n">DocDict</span><span class="p">({</span>

        <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Anti-passback disabled&#39;</span><span class="p">,</span>

        <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Enable the anti-passback function between Door 1 and Door 2 (one-way) &#39;</span>

           <span class="s1">&#39;or readers of Door 1 (two-way)&#39;</span><span class="p">,</span>

        <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;Enable the anti-passback function between readers of Door 2 (two-way)&#39;</span><span class="p">,</span>

        <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;Enable the anti-passback function between readers of Door 1 and between readers of &#39;</span>

           <span class="s1">&#39;Door 2 respectively (two-way)&#39;</span><span class="p">,</span>

        <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;Enable the anti-passback function between Door 1 and Door 2 (two-way)&#39;</span>

    <span class="p">})</span>

    <span class="n">interlock_rules</span> <span class="o">=</span> <span class="n">DocDict</span><span class="p">({</span>

        <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Interlock disabled&#39;</span><span class="p">,</span>

        <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Interlock Door 1 and Door 2 mutually&#39;</span><span class="p">,</span>

    <span class="p">})</span>

<span class="k">class</span> <span class="nc">ZK100</span><span class="p">(</span><span class="n">ZKModel</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;ZKAccess C3-100&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;C3-100&#39;</span>

    <span class="n">relays</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="n">relays_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">groups_def</span> <span class="o">=</span> <span class="p">(</span><span class="n">RelayGroup</span><span class="o">.</span><span class="n">aux</span><span class="p">,</span> <span class="n">RelayGroup</span><span class="o">.</span><span class="n">lock</span><span class="p">)</span>

    <span class="n">readers_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>  <span class="c1"># FIXME: fix ZKAccess.doors for C3-100</span>

    <span class="n">doors_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>

    <span class="n">aux_inputs_def</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">)</span>  <span class="c1"># FIXME: fix ZKAccess.doors for C3-100</span>

    <span class="n">anti_passback_rules</span> <span class="o">=</span> <span class="n">DocDict</span><span class="p">({</span>

        <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Anti-passback disabled&#39;</span><span class="p">,</span>

        <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Enable the anti-passback function between the readers of Door1 (two-way)&#39;</span><span class="p">,</span>

    <span class="p">})</span>

    <span class="n">interlock_rules</span> <span class="o">=</span> <span class="n">DocDict</span><span class="p">({</span>

        <span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Interlock disabled&#39;</span><span class="p">,</span>

    <span class="p">})</span>

<span class="k">class</span> <span class="nc">ZKDevice</span><span class="p">:</span>

    <span class="sd">&quot;&quot;&quot;Concrete ZK device info&quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mac&#39;</span><span class="p">,</span> <span class="s1">&#39;ip&#39;</span><span class="p">,</span> <span class="s1">&#39;serial_number&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;version&#39;</span><span class="p">)</span>

    <span class="n">parse_tokens</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;MAC&#39;</span><span class="p">,</span> <span class="s1">&#39;IP&#39;</span><span class="p">,</span> <span class="s1">&#39;SN&#39;</span><span class="p">,</span> <span class="s1">&#39;Device&#39;</span><span class="p">,</span> <span class="s1">&#39;Ver&#39;</span><span class="p">)</span>  <span class="c1"># The same order as __slots__</span>

    <span class="n">available_models</span> <span class="o">=</span> <span class="p">(</span><span class="n">ZK100</span><span class="p">,</span> <span class="n">ZK200</span><span class="p">,</span> <span class="n">ZK400</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>

            <span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">params</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;You must specify device string or object attributes as kwargs&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mac</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;mac&#39;</span><span class="p">]</span>  <span class="c1"># type: Optional[str]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">]</span>  <span class="c1"># type: str</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">serial_number</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;serial_number&#39;</span><span class="p">]</span>  <span class="c1"># type: str</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_model_cls</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">])</span>  <span class="c1"># type: type(ZKModel)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>  <span class="c1"># type: Optional[str]</span>

    <span class="k">def</span> <span class="nf">parse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_line</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>

        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parse and validate raw device string</span>

<span class="sd">        :param device_line: event string</span>

<span class="sd">        :return: dictionary where keys are slots and values are</span>

<span class="sd">         appropriate values extracted from string</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">device_line</span> <span class="o">=</span> <span class="n">device_line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">tokens_mapping</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_tokens</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">))</span>

        <span class="n">pieces</span> <span class="o">=</span> <span class="n">device_line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">piece</span> <span class="ow">in</span> <span class="n">pieces</span><span class="p">:</span>

            <span class="n">tok</span><span class="p">,</span> <span class="n">val</span> <span class="o">=</span> <span class="n">piece</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">tok</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tokens_mapping</span><span class="p">:</span>

                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown param &#39;{}={}&#39; found in device string &#39;{}&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>

                    <span class="n">tok</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">device_line</span>

                <span class="p">))</span>

            <span class="n">res</span><span class="p">[</span><span class="n">tokens_mapping</span><span class="p">[</span><span class="n">tok</span><span class="p">]]</span> <span class="o">=</span> <span class="n">val</span>  <span class="c1"># {slot: value}</span>

        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Some keys was not found in device string &#39;{}&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">device_line</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">res</span>

    <span class="k">def</span> <span class="nf">_get_model_cls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">(</span><span class="n">ZKModel</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">ZKModel</span><span class="p">):</span>

            <span class="k">return</span> <span class="n">model_name</span>

        <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">available_models</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">model_name</span><span class="p">:</span>

                <span class="k">return</span> <span class="bp">cls</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unknown device model &#39;{}&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model_name</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ZKDevice</span><span class="p">):</span>

            <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="o">==</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>

        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">params</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;{}={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__slots__</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;Device[{}]({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</code></pre></div>


</details>
<h2 id="classes">Classes</h2>
<h3 id="zk100">ZK100</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ZK100</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>


<p>ZKAccess C3-100</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">ZK100</span>(<span class="n">ZKModel</span>):

    <span class="s">&quot;&quot;&quot;ZKAccess C3-100&quot;&quot;&quot;</span>

    <span class="nb">name</span> = <span class="s">&#39;C3-100&#39;</span>

    <span class="n">relays</span> = <span class="mi">2</span>

    <span class="n">relays_def</span> = (<span class="mi">1</span>, <span class="mi">2</span>)

    <span class="n">groups_def</span> = (<span class="n">RelayGroup</span>.<span class="n">aux</span>, <span class="n">RelayGroup</span>.<span class="nb">lock</span>)

    <span class="n">readers_def</span> = (<span class="mi">1</span>, )  <span class="c1"># FIXME: fix ZKAccess.doors for C3-100</span>

    <span class="n">doors_def</span> = (<span class="mi">1</span>, )

    <span class="n">aux_inputs_def</span> = (<span class="mi">1</span>, )  <span class="c1"># FIXME: fix ZKAccess.doors for C3-100</span>

    <span class="n">anti_passback_rules</span> = <span class="n">DocDict</span>({

        <span class="mi">0</span>: <span class="s">&#39;Anti-passback disabled&#39;</span>,

        <span class="mi">1</span>: <span class="s">&#39;Enable the anti-passback function between the readers of Door1 (two-way)&#39;</span>,

    })

    <span class="n">interlock_rules</span> = <span class="n">DocDict</span>({

        <span class="mi">0</span>: <span class="s">&#39;Interlock disabled&#39;</span>,

    })
</code></pre></div>


</details>
<hr />
<h4 id="ancestors-in-mro">Ancestors (in MRO)</h4>
<ul>
<li>pyzkaccess.device.ZKModel</li>
</ul>
<h4 id="class-variables">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">anti_passback_rules</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">aux_inputs_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">doors_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">doors_dev</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">groups_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">interlock_rules</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">name</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">readers_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">relays</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">relays_def</span>
</code></pre></div>


<h3 id="zk200">ZK200</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ZK200</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>


<p>ZKAccess C3-200</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">ZK200</span>(<span class="n">ZKModel</span>):

    <span class="s">&quot;&quot;&quot;ZKAccess C3-200&quot;&quot;&quot;</span>

    <span class="nb">name</span> = <span class="s">&#39;C3-200&#39;</span>

    <span class="n">relays</span> = <span class="mi">4</span>

    <span class="n">relays_def</span> = (<span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">1</span>, <span class="mi">2</span>)

    <span class="n">groups_def</span> = (<span class="n">RelayGroup</span>.<span class="n">aux</span>, <span class="n">RelayGroup</span>.<span class="n">aux</span>, <span class="n">RelayGroup</span>.<span class="nb">lock</span>, <span class="n">RelayGroup</span>.<span class="nb">lock</span>)

    <span class="n">readers_def</span> = (<span class="mi">1</span>, <span class="mi">2</span>)  <span class="c1"># FIXME: fix ZKAccess.doors for C3-200</span>

    <span class="n">doors_def</span> = (<span class="mi">1</span>, <span class="mi">2</span>)

    <span class="n">aux_inputs_def</span> = (<span class="mi">1</span>, <span class="mi">2</span>)

    <span class="n">anti_passback_rules</span> = <span class="n">DocDict</span>({

        <span class="mi">0</span>: <span class="s">&#39;Anti-passback disabled&#39;</span>,

        <span class="mi">1</span>: <span class="s">&#39;Enable the anti-passback function between Door 1 and Door 2 (one-way) &#39;</span>

           <span class="s">&#39;or readers of Door 1 (two-way)&#39;</span>,

        <span class="mi">2</span>: <span class="s">&#39;Enable the anti-passback function between readers of Door 2 (two-way)&#39;</span>,

        <span class="mi">3</span>: <span class="s">&#39;Enable the anti-passback function between readers of Door 1 and between readers of &#39;</span>

           <span class="s">&#39;Door 2 respectively (two-way)&#39;</span>,

        <span class="mi">4</span>: <span class="s">&#39;Enable the anti-passback function between Door 1 and Door 2 (two-way)&#39;</span>

    })

    <span class="n">interlock_rules</span> = <span class="n">DocDict</span>({

        <span class="mi">0</span>: <span class="s">&#39;Interlock disabled&#39;</span>,

        <span class="mi">1</span>: <span class="s">&#39;Interlock Door 1 and Door 2 mutually&#39;</span>,

    })
</code></pre></div>


</details>
<hr />
<h4 id="ancestors-in-mro_1">Ancestors (in MRO)</h4>
<ul>
<li>pyzkaccess.device.ZKModel</li>
</ul>
<h4 id="class-variables_1">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">anti_passback_rules</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">aux_inputs_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">doors_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">doors_dev</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">groups_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">interlock_rules</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">name</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">readers_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">relays</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">relays_def</span>
</code></pre></div>


<h3 id="zk400">ZK400</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ZK400</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>


<p>ZKAccess C3-400 model</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">ZK400</span>(<span class="n">ZKModel</span>):

    <span class="s">&quot;&quot;&quot;ZKAccess C3-400 model&quot;&quot;&quot;</span>

    <span class="nb">name</span> = <span class="s">&#39;C3-400&#39;</span>

    <span class="n">relays</span> = <span class="mi">8</span>

    <span class="n">relays_def</span> = (

        <span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>,

        <span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>

    )

    <span class="n">groups_def</span> = (

        <span class="n">RelayGroup</span>.<span class="n">aux</span>, <span class="n">RelayGroup</span>.<span class="n">aux</span>, <span class="n">RelayGroup</span>.<span class="n">aux</span>, <span class="n">RelayGroup</span>.<span class="n">aux</span>,

        <span class="n">RelayGroup</span>.<span class="nb">lock</span>, <span class="n">RelayGroup</span>.<span class="nb">lock</span>, <span class="n">RelayGroup</span>.<span class="nb">lock</span>, <span class="n">RelayGroup</span>.<span class="nb">lock</span>

    )

    <span class="n">readers_def</span> = (<span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>)

    <span class="n">doors_def</span> = (<span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>)

    <span class="n">aux_inputs_def</span> = (<span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>)

    <span class="n">anti_passback_rules</span> = <span class="n">DocDict</span>({

        <span class="mi">0</span>:   <span class="s">&#39;Anti-passback disabled&#39;</span>,

        <span class="mi">1</span>:   <span class="s">&#39;Enable the anti-passback function Door 1 and Door 2&#39;</span>,

        <span class="mi">2</span>:   <span class="s">&#39;Enable the anti•passback function between Door 3 and Door 4&#39;</span>,

        <span class="mi">3</span>:   <span class="s">&#39;Enable the anti-passback function between Door 1 and Door 2, and between &#39;</span>

             <span class="s">&#39;Door 3 and Door 4&#39;</span>,

        <span class="mi">4</span>:   <span class="s">&#39;Enable the anti-passback function between Door 1,2 and Door 3,4&#39;</span>,

        <span class="mi">5</span>:   <span class="s">&#39;Enable the anti-passback function between Door 1 and Door 2,3&#39;</span>,

        <span class="mi">6</span>:   <span class="s">&#39;Enable the anti-passback function between Door 1 and Door 2,3,4&#39;</span>,

        <span class="mi">16</span>:  <span class="s">&#39;Anti-passback is supported only between the readers of Door 1&#39;</span>,

        <span class="mi">32</span>:  <span class="s">&#39;Anti-passback is supported only between the readers of Door 2&#39;</span>,

        <span class="mi">64</span>:  <span class="s">&#39;Anti-passback is supported only between the readers of Door 3&#39;</span>,

        <span class="mi">128</span>: <span class="s">&#39;Anti-passback is supported only between the readers of Door 4&#39;</span>,

        <span class="mi">96</span>:  <span class="s">&#39;Anti-passback is supported concurrently among Door 2 and Door 3 readers respectively&#39;</span>,

        <span class="mi">160</span>: <span class="s">&#39;Anti-passback is supported concurrently among Door 2 and Door 4 readers respectively&#39;</span>,

        <span class="mi">196</span>: <span class="s">&#39;Anti-passback is supported concurrently among Door 3 and Door 4 readers respectively&#39;</span>,

        <span class="mi">112</span>: <span class="s">&#39;Anti-passback is supported concurrently among Door 1, 2, 3 readers respectively&#39;</span>,

        <span class="mi">176</span>: <span class="s">&#39;Anti-passback is supported concurrently among Door 1, 2, 4 readers respectively&#39;</span>,

        <span class="mi">208</span>: <span class="s">&#39;Anti-passback is supported concurrently among Door 1, 3, 4 readers respectively&#39;</span>,

        <span class="mi">224</span>: <span class="s">&#39;Anti-passback is supported concurrently among Door 2, 3, 4 readers respectively&#39;</span>,

        <span class="mi">240</span>: <span class="s">&#39;Anti-passback is supported concurrently among Door 1, 2, 3, 4 readers respectively&#39;</span>,

    })

    <span class="n">interlock_rules</span> = <span class="n">DocDict</span>({

        <span class="mi">0</span>: <span class="s">&#39;Interlock disabled&#39;</span>,

        <span class="mi">1</span>: <span class="s">&#39;Interlock Door 1 and Door 2 mutually&#39;</span>,

        <span class="mi">2</span>: <span class="s">&#39;Interlock Door 3 and Door 4 mutually&#39;</span>,

        <span class="mi">3</span>: <span class="s">&#39;Interlock Door 1, Door 2 and Door 3 mutually&#39;</span>,

        <span class="mi">4</span>: <span class="s">&#39;Interlock Door 1 and Door 2 mutually and interlock Door 3 and Door 4 mutually&#39;</span>,

        <span class="mi">5</span>: <span class="s">&#39;Interlock Door 1, Door 2, Door 3, Door 4 mutually&#39;</span>,

    })
</code></pre></div>


</details>
<hr />
<h4 id="ancestors-in-mro_2">Ancestors (in MRO)</h4>
<ul>
<li>pyzkaccess.device.ZKModel</li>
</ul>
<h4 id="class-variables_2">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">anti_passback_rules</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">aux_inputs_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">doors_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">doors_dev</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">groups_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">interlock_rules</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">name</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">readers_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">relays</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">relays_def</span>
</code></pre></div>


<h3 id="zkdevice">ZKDevice</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ZKDevice</span><span class="p">(</span>
    <span class="n">s</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">params</span>
<span class="p">)</span>
</code></pre></div>


<p>Concrete ZK device info</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nl">ZKDevice</span><span class="p">:</span><span class="w"></span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Concrete ZK device info&quot;&quot;&quot;</span><span class="w"></span>

<span class="w">    </span><span class="n">__slots__</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;mac&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ip&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;serial_number&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;model&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;version&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">parse_tokens</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;MAC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;IP&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SN&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Device&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Ver&#39;</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">__slots__</span><span class="w"></span>

<span class="w">    </span><span class="n">available_models</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ZK100</span><span class="p">,</span><span class="w"> </span><span class="n">ZK200</span><span class="p">,</span><span class="w"> </span><span class="n">ZK400</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="o">=</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">params</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">params</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">TypeError</span><span class="p">(</span><span class="s1">&#39;You must specify device string or object attributes as kwargs&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">mac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="o">[</span><span class="n">&#39;mac&#39;</span><span class="o">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">ip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="o">[</span><span class="n">&#39;ip&#39;</span><span class="o">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">serial_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="o">[</span><span class="n">&#39;serial_number&#39;</span><span class="o">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_get_model_cls</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="n">&#39;model&#39;</span><span class="o">]</span><span class="p">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">ZKModel</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="o">[</span><span class="n">&#39;version&#39;</span><span class="o">]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="nl">type</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">str</span><span class="o">]</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">device_line</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Mapping</span><span class="o">[</span><span class="n">str, str</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Parse and validate raw device string</span>

<span class="ss">        :param device_line: event string</span>

<span class="ss">        :return: dictionary where keys are slots and values are</span>

<span class="ss">         appropriate values extracted from string</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">device_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device_line</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="s1">&#39;\r\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span><span class="w"></span>

<span class="w">        </span><span class="n">tokens_mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="p">(</span><span class="n">zip</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">parse_tokens</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__slots__</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="n">pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device_line</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">piece</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">pieces</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">tok</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piece</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">tok</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">tokens_mapping</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Unknown param &#39;{}={}&#39; found in device string &#39;{}&#39;&quot;</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="w"></span>

<span class="w">                    </span><span class="n">tok</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">device_line</span><span class="w"></span>

<span class="w">                </span><span class="p">))</span><span class="w"></span>

<span class="w">            </span><span class="n">res</span><span class="o">[</span><span class="n">tokens_mapping[tok</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">val</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">{</span><span class="nl">slot</span><span class="p">:</span><span class="w"> </span><span class="k">value</span><span class="err">}</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">res</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__slots__</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Some keys was not found in device string &#39;{}&#39;&quot;</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">device_line</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">_get_model_cls</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">model_name</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">type</span><span class="p">(</span><span class="n">ZKModel</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">issubclass</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span><span class="w"> </span><span class="n">ZKModel</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">model_name</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">cls</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">available_models</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">cls</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nl">model_name</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">cls</span><span class="w"></span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Unknown device model &#39;{}&#39;&quot;</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">model_name</span><span class="p">))</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__eq__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="w"> </span><span class="n">ZKDevice</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="ow">all</span><span class="p">(</span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span><span class="w"> </span><span class="n">attr</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">attr</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__slots__</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">False</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__ne__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__str__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="n">params</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;, &#39;</span><span class="p">.</span><span class="k">join</span><span class="p">(</span><span class="s1">&#39;{}={}&#39;</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">getattr</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;?&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__slots__</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s1">&#39;Device[{}]({})&#39;</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">params</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__repr__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__str__</span><span class="p">()</span><span class="w"></span>
</code></pre></div>


</details>
<hr />
<h4 id="class-variables_3">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">available_models</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">parse_tokens</span>
</code></pre></div>


<h4 id="instance-variables">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">ip</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">mac</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">model</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">serial_number</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">version</span>
</code></pre></div>


<h4 id="methods">Methods</h4>
<h5 id="parse">parse</h5>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">parse</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">device_line</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
</code></pre></div>


<p>Parse and validate raw device string
:param device_line: event string
:return: dictionary where keys are slots and values are
 appropriate values extracted from string</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">device_line</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Mapping</span><span class="o">[</span><span class="n">str, str</span><span class="o">]</span><span class="err">:</span><span class="w"></span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;</span>

<span class="ss">        Parse and validate raw device string</span>

<span class="ss">        :param device_line: event string</span>

<span class="ss">        :return: dictionary where keys are slots and values are</span>

<span class="ss">         appropriate values extracted from string</span>

<span class="ss">        &quot;&quot;&quot;</span><span class="w"></span>

<span class="w">        </span><span class="n">device_line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device_line</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="s1">&#39;\r\n&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span><span class="w"></span>

<span class="w">        </span><span class="n">tokens_mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dict</span><span class="p">(</span><span class="n">zip</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">parse_tokens</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">__slots__</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="n">pieces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">device_line</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">piece</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">pieces</span><span class="p">:</span><span class="w"></span>

<span class="w">            </span><span class="n">tok</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piece</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="w"></span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">tok</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">tokens_mapping</span><span class="p">:</span><span class="w"></span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Unknown param &#39;{}={}&#39; found in device string &#39;{}&#39;&quot;</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="w"></span>

<span class="w">                    </span><span class="n">tok</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">device_line</span><span class="w"></span>

<span class="w">                </span><span class="p">))</span><span class="w"></span>

<span class="w">            </span><span class="n">res</span><span class="o">[</span><span class="n">tokens_mapping[tok</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">val</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">{</span><span class="nl">slot</span><span class="p">:</span><span class="w"> </span><span class="k">value</span><span class="err">}</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">res</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">set</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">__slots__</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Some keys was not found in device string &#39;{}&#39;&quot;</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">device_line</span><span class="p">))</span><span class="w"></span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">res</span><span class="w"></span>
</code></pre></div>


</details>
<h3 id="zkmodel">ZKModel</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ZKModel</span><span class="p">(</span>
    <span class="o">/</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span>
</code></pre></div>


<p>Base class for concrete ZK model Contains model-specific
definitions</p>
<details class="example"><summary>View Source</summary><div class="codehilite"><pre><span></span><code><span class="n">class</span> <span class="n">ZKModel</span><span class="p">:</span>

    <span class="s2">&quot;&quot;&quot;Base class for concrete ZK model Contains model-specific</span>

<span class="s2">    definitions</span>

<span class="s2">    &quot;&quot;&quot;</span>

    <span class="c1">#: Name of model</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">None</span>

    <span class="c1">#: Relays count</span>

    <span class="n">relays</span> <span class="o">=</span> <span class="n">None</span>

    <span class="c1">#: Definition of relay numbers (count must be equal to `relays`)</span>

    <span class="n">relays_def</span> <span class="o">=</span> <span class="n">None</span>

    <span class="c1">#: Definition of relay groups (count must be equal to `relays`)</span>

    <span class="n">groups_def</span> <span class="o">=</span> <span class="n">None</span>

    <span class="c1">#: Definition of reader numbers</span>

    <span class="n">readers_def</span> <span class="o">=</span> <span class="n">None</span>

    <span class="c1">#: Definition of door numbers</span>

    <span class="n">doors_dev</span> <span class="o">=</span> <span class="n">None</span>

    <span class="c1">#: Definition of aux input numbers</span>

    <span class="n">aux_inputs_def</span> <span class="o">=</span> <span class="n">None</span>

    <span class="c1">#: Anti-passback rules available on concrete device model</span>

    <span class="n">anti_passback_rules</span> <span class="o">=</span> <span class="n">None</span>

    <span class="c1">#: Interlock rules available on concrete device model</span>

    <span class="n">interlock_rules</span> <span class="o">=</span> <span class="n">None</span>
</code></pre></div>


</details>
<hr />
<h4 id="descendants">Descendants</h4>
<ul>
<li>pyzkaccess.device.ZK400</li>
<li>pyzkaccess.device.ZK200</li>
<li>pyzkaccess.device.ZK100</li>
</ul>
<h4 id="class-variables_4">Class variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">anti_passback_rules</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">aux_inputs_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">doors_dev</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">groups_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">interlock_rules</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">name</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">readers_def</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">relays</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">relays_def</span>
</code></pre></div>
            
          
        </div>
      </div>
    </div>
    <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
      <div class="sphinxsidebarwrapper">
        
          
            
  <h1 class="logo"><a href="../../..">pyzkaccess</a></h1>



          
            



<h3>Table Of Contents</h3>

<nav>
  
  
    <ul>
    
      <li><a href="#classes">Classes</a></li>
      <ul>
    
      <li><a href="#zk100">ZK100</a></li>
      <ul>
    
      <li><a href="#ancestors-in-mro">Ancestors (in MRO)</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#class-variables">Class variables</a></li>
      <ul>
    
  </ul>
    
  </ul>
    
      <li><a href="#zk200">ZK200</a></li>
      <ul>
    
      <li><a href="#ancestors-in-mro_1">Ancestors (in MRO)</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#class-variables_1">Class variables</a></li>
      <ul>
    
  </ul>
    
  </ul>
    
      <li><a href="#zk400">ZK400</a></li>
      <ul>
    
      <li><a href="#ancestors-in-mro_2">Ancestors (in MRO)</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#class-variables_2">Class variables</a></li>
      <ul>
    
  </ul>
    
  </ul>
    
      <li><a href="#zkdevice">ZKDevice</a></li>
      <ul>
    
      <li><a href="#class-variables_3">Class variables</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#instance-variables">Instance variables</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#methods">Methods</a></li>
      <ul>
    
      <li><a href="#parse">parse</a></li>
      <ul>
    
  </ul>
    
  </ul>
    
  </ul>
    
      <li><a href="#zkmodel">ZKModel</a></li>
      <ul>
    
      <li><a href="#descendants">Descendants</a></li>
      <ul>
    
  </ul>
    
      <li><a href="#class-variables_4">Class variables</a></li>
      <ul>
    
  </ul>
    
  </ul>
    
  </ul>
    
  </ul>
  

  
</nav>
          
            
  <h3>Related Topics</h3>
  <ul>
    
      <li>Previous: <a href="../ctypes/" title="previous chapter">
        Ctypes
      </a></li>
    
    
      <li>Next: <a href="../door/" title="next chapter">
        Door
      </a></li>
    
  </ul>

          
            <div id="searchbox" style="display: none;" role="search">
  <h3>Quick search</h3>
  <form class="search" action="../../../search.html" method="get">
    <input name="q" type="text">
    <input value="Go" type="submit">
  </form>
  <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
  </p>
</div>
<script type="text/javascript">
  document.getElementById("searchbox").style.display = "block";
</script>
          
        
      </div>
    </div>
    <div class="clearer"></div>
  </div>

  
    <div class="footer">
      
      
        
        Powered by <a href="http://www.mkdocs.org">mkdocs 1.1.2</a>
        &amp; <a href="https://github.com/iamale/mkdocs-alabaster">mkdocs-alabaster</a>
      
    </div>
  

  <!--
  MkDocs version      : 1.1.2
  Docs Build Date UTC : 2020-09-07 21:14:19.858939+00:00
  -->
</body>
</html>